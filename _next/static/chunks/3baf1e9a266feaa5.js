(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15125,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a={VALID_LOADERS:function(){return i},imageConfigDefault:function(){return d}};for(var r in a)Object.defineProperty(s,r,{enumerable:!0,get:a[r]});let i=["default","imgix","cloudinary","akamai","custom"],d={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[32,48,64,96,128,256,384],path:"/_next/image",loader:"default",loaderFile:"",domains:[],disableStaticImages:!1,minimumCacheTTL:14400,formats:["image/webp"],maximumRedirects:3,dangerouslyAllowLocalIP:!1,dangerouslyAllowSVG:!1,contentSecurityPolicy:"script-src 'none'; frame-src 'none'; sandbox;",contentDispositionType:"attachment",localPatterns:void 0,remotePatterns:[],qualities:[75],unoptimized:!1}},13521,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"ImageConfigContext",{enumerable:!0,get:function(){return i}});let a=e.r(41705)._(e.r(91788)),r=e.r(15125),i=a.default.createContext(r.imageConfigDefault)},32201,e=>{"use strict";var t=e.i(91398),s=e.i(91788),a=e.i(3828),r=e.i(44054),i=e.i(36613);e.i(50461);var d=e.i(77934);function n({productSet:e,onDelete:r,onGenerateQR:n,qrCodeCount:o,qrCodes:l=[]}){let c,u,m,h=(0,a.useRouter)(),[p,f]=(0,s.useState)(!1),g=async()=>{if(confirm(`are you sure you want to delete "${e.name}"? this action cannot be undone.`)){f(!0);try{await (0,i.deleteProductSet)(e.id),r(e.id)}catch(e){console.error("failed to delete wmcyn product:",e),"Resource not found"===e.message?alert("Delete endpoint not available on backend. The product may need to be deleted directly from the database."):alert(`failed to delete wmcyn product: ${e.message}`)}finally{f(!1)}}},x=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),y=async(e,t)=>{try{let s=await fetch(e),a=await s.blob(),r=window.URL.createObjectURL(a),i=document.createElement("a");i.href=r,i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(r)}catch(e){console.error("failed to download QR code:",e),alert("failed to download QR code")}},b=e.stats||{totalClaims:0,remainingInventory:0,qrCodesGenerated:0};return(0,t.jsxs)("div",{className:d.default.productSetCard,children:[(0,t.jsx)("div",{className:d.default.productSetCardHeader,children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:d.default.productSetCardTitle,children:e.name}),e.description&&(0,t.jsx)("p",{className:d.default.productSetCardDescription,children:e.description}),e.campaign&&(0,t.jsxs)("p",{className:d.default.productSetCardDescription,children:[(0,t.jsx)("strong",{children:"campaign:"})," ",e.campaign]}),e.linkedARSessionId&&(0,t.jsxs)("p",{className:d.default.productSetCardDescription,children:[(0,t.jsx)("strong",{children:"AR experience:"})," ",(0,t.jsx)("span",{style:{color:"#60a5fa"},children:"enabled"})]})]})}),(0,t.jsxs)("div",{className:d.default.productSetCardStats,children:[(0,t.jsxs)("div",{className:d.default.statItem,children:[(0,t.jsx)("div",{className:d.default.statValue,children:e.items&&Array.isArray(e.items)?e.items.reduce((e,t)=>e+(t.quantity||t.qty||1),0):0}),(0,t.jsx)("div",{className:d.default.statLabel,children:"total items"})]}),(0,t.jsxs)("div",{className:d.default.statItem,children:[(0,t.jsx)("div",{className:d.default.statValue,children:b.totalClaims}),(0,t.jsx)("div",{className:d.default.statLabel,children:"claims"})]}),(0,t.jsxs)("div",{className:d.default.statItem,children:[(0,t.jsx)("div",{className:d.default.statValue,children:b.remainingInventory}),(0,t.jsx)("div",{className:d.default.statLabel,children:"remaining"})]}),(0,t.jsxs)("div",{className:d.default.statItem,children:[(0,t.jsx)("div",{className:d.default.statValue,children:o??b.qrCodesGenerated}),(0,t.jsx)("div",{className:d.default.statLabel,children:"qr codes"})]})]}),(0,t.jsxs)("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"16px",textAlign:"center"},children:[e.createdAt&&(0,t.jsxs)(t.Fragment,{children:["created ",x(e.createdAt)]}),e.updatedAt&&e.updatedAt!==e.createdAt&&(0,t.jsxs)("span",{children:[" â€¢ updated ",x(e.updatedAt)]})]}),l&&l.length>0&&(c=l[0],u=c.assets?.qrPngUrl||`https://api-rrm3u3yaba-uc.a.run.app/api/qr-assets/${c.code}.png`,m=c.assets?.qrSvgUrl||`https://api-rrm3u3yaba-uc.a.run.app/api/qr-assets/${c.code}.svg`,(0,t.jsxs)("div",{style:{marginBottom:"12px",display:"flex",gap:"8px",justifyContent:"center"},children:[(0,t.jsx)("button",{onClick:()=>y(u,`qr-code-${c.code}.png`),style:{padding:"6px 12px",background:"rgba(255, 255, 255, 0.1)",color:"white",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"4px",cursor:"pointer",fontSize:"0.75rem",fontWeight:"500"},children:"download png"}),(0,t.jsx)("button",{onClick:()=>y(m,`qr-code-${c.code}.svg`),style:{padding:"6px 12px",background:"rgba(255, 255, 255, 0.1)",color:"white",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"4px",cursor:"pointer",fontSize:"0.75rem",fontWeight:"500"},children:"download svg"})]})),(0,t.jsxs)("div",{className:d.default.productSetCardActions,children:[(0,t.jsx)("button",{onClick:()=>{h.push(`/admin/product-sets/${e.id}`)},className:`${d.default.buttonSecondary} ${d.default.buttonSmall}`,children:"edit"}),(0,t.jsx)("button",{onClick:()=>n(e),className:`${d.default.buttonPrimary} ${d.default.buttonSmall}`,children:"generate qr"}),(0,t.jsx)("button",{onClick:()=>{h.push(`/admin/product-sets/${e.id}/details`)},className:`${d.default.buttonSecondary} ${d.default.buttonSmall}`,children:"details"}),(0,t.jsx)("button",{onClick:g,disabled:p,className:`${d.default.buttonDanger} ${d.default.buttonSmall}`,style:{opacity:p?.6:1,cursor:p?"not-allowed":"pointer"},children:p?"deleting...":"delete"})]})]})}var o=e.i(50080),l=e.i(32750);function c(){let{isAuthenticated:e,logout:c,loading:u}=(0,r.useAdminAuth)(),m=(0,a.useRouter)(),[h,p]=(0,s.useState)([]),[f,g]=(0,s.useState)([]),[x,y]=(0,s.useState)({}),[b,j]=(0,s.useState)({}),[v,S]=(0,s.useState)(!0),[A,N]=(0,s.useState)(""),[C,w]=(0,s.useState)(null),[R,P]=(0,s.useState)(""),[k,D]=(0,s.useState)(null),[_,q]=(0,s.useState)(!1);(0,s.useEffect)(()=>{u||e||m.push("/admin/login")},[e,u,m]),(0,s.useEffect)(()=>{e&&$()},[e]);let I=async()=>{try{N("");let e=await (0,i.getProductSets)();console.log("[AdminDashboard] Product sets raw response:",e);let t=[];Array.isArray(e)?t=e:e?.items?t=e.items:e?.productSets?t=e.productSets:e?.products?t=e.products:e?.data&&(t=Array.isArray(e.data)?e.data:[]),console.log("[AdminDashboard] Parsed product sets:",t.length,"items");let s=Array.isArray(t)?t:[];return p(s),s}catch(e){return console.error("failed to load wmcyn products:",e),N(e.message||"failed to load wmcyn products"),p([]),[]}},T=async e=>{try{let t=e||h;if(0===t.length)return void console.log("[AdminDashboard] No product sets to load QR codes for");let s={};await Promise.all(t.map(async e=>{try{let t=await (0,i.getQRCodes)(e.id);console.log(`[AdminDashboard] QR codes for ${e.id}:`,t);let a=[];Array.isArray(t)?a=t:t?.qrcodes?a=t.qrcodes:t?.qrCodes?a=t.qrCodes:t?.items?a=t.items:t?.data&&(a=Array.isArray(t.data)?t.data:[]),console.log(`[AdminDashboard] Parsed QR codes for ${e.id}:`,a.length,a),s[e.id]=a.length,a.length>0&&j(t=>({...t,[e.id]:a}))}catch(t){console.error(`[AdminDashboard] Failed to load QR codes for ${e.id}:`,t),s[e.id]=0}})),console.log("[AdminDashboard] QR code counts per product set:",s),y(s)}catch(e){console.error("failed to load qr codes:",e)}},L=async()=>{try{console.log("loading ar sessions, isAuthenticated:",e),w(null);let t=await i.arSessions.list();console.log("[AdminDashboard] AR sessions response:",t);let s=Array.isArray(t)?t:t?.arSessions||t?.sessions||[];g(s)}catch(e){console.error("failed to load ar sessions:",e),e.message?.includes("invalid token")?w("Authentication failed - the admin API token may be invalid or the backend needs to be updated"):e.message?.includes("Access denied")?w("Access denied - admin privileges required for AR sessions"):e.message?.includes("Authentication required")?w("Authentication required - check if NEXT_PUBLIC_ADMIN_API_TOKEN is configured correctly"):"unauthorized"===e.message||e.message?.includes("401")?w("AR sessions API endpoint requires authentication - check backend deployment status"):w(`Failed to load AR sessions: ${e.message}`),g([])}},$=async()=>{S(!0);let[t]=await Promise.all([I(),e?L():Promise.resolve()]);await T(t),S(!1)},z=()=>{m.push("/admin/product-sets/new")},O=e=>{p(t=>t.filter(t=>t.id!==e))},B=e=>{D(e),q(!0)},E=async()=>{let e=await I();await T(e)},U=(h||[]).filter(e=>e.name.toLowerCase().includes(R.toLowerCase())||e.description&&e.description.toLowerCase().includes(R.toLowerCase())||e.campaign&&e.campaign.toLowerCase().includes(R.toLowerCase()));return u||v?(0,t.jsx)("div",{className:d.default.adminPageContainer,children:(0,t.jsx)("div",{className:d.default.adminContainer,children:(0,t.jsx)("div",{className:d.default.loadingContainer,children:"loading..."})})}):e?(0,t.jsx)("div",{className:d.default.adminPageContainer,children:(0,t.jsxs)("div",{className:d.default.adminContainer,children:[(0,t.jsxs)("div",{className:d.default.adminHeader,children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[(0,t.jsx)(l.default,{src:"/wmcyn_logo_white.png",alt:"WMCYN Logo",width:80,height:40,priority:!0}),(0,t.jsx)("h1",{className:d.default.adminTitle,children:"Admin Dashboard"})]}),(0,t.jsxs)("div",{className:d.default.adminActions,children:[(0,t.jsx)("button",{onClick:z,className:d.default.buttonPrimary,children:"Create AR Product"}),(0,t.jsx)("button",{onClick:()=>{c()},className:d.default.buttonSecondary,children:"Logout"})]})]}),(0,t.jsxs)("div",{className:d.default.adminTabs,children:[(0,t.jsx)("button",{className:`${d.default.tabButton} ${d.default.active}`,onClick:()=>m.push("/admin"),children:"AR Products"}),(0,t.jsx)("button",{className:d.default.tabButton,onClick:()=>m.push("/admin/ar-sessions"),children:"AR Sessions"})]}),(0,t.jsxs)("div",{className:d.default.searchContainer,children:[(0,t.jsx)("input",{type:"text",placeholder:"Search AR products...",value:R,onChange:e=>P(e.target.value),className:d.default.searchInput}),(0,t.jsx)("button",{onClick:$,className:d.default.buttonSecondary,children:"Refresh"})]}),A&&(0,t.jsx)("div",{className:d.default.errorContainer,children:A}),(0,t.jsxs)("div",{style:{marginBottom:"24px",padding:"16px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",fontSize:"0.9rem",color:"rgba(255, 255, 255, 0.8)"},children:[(0,t.jsxs)("p",{style:{margin:"0 0 8px 0"},children:[(0,t.jsx)("strong",{children:"AR products:"})," AR experiences with custom markers, metadata overlays, and QR codes"]}),(0,t.jsxs)("p",{style:{margin:"0 0 8px 0"},children:[(0,t.jsx)("strong",{children:"ar sessions:"})," immersive AR experiences with custom markers and interactive overlays"]}),(0,t.jsx)("p",{style:{margin:"0",fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.6)"},children:(0,t.jsx)("em",{children:"Note: AR sessions may require NEXT_PUBLIC_ADMIN_API_TOKEN for authentication. Frontend is ready!"})})]}),U.length>0?(0,t.jsx)("div",{className:d.default.productSetsGrid,children:U.map(e=>(0,t.jsx)(n,{productSet:e,onDelete:O,onGenerateQR:B,qrCodeCount:x[e.id]||0,qrCodes:b[e.id]||[]},e.id))}):!v&&(0,t.jsxs)("div",{className:d.default.emptyState,children:[(0,t.jsx)("h2",{className:d.default.emptyStateTitle,children:R?"no matching AR products":"no AR products yet"}),(0,t.jsx)("p",{className:d.default.emptyStateDescription,children:R?"try adjusting your search terms":"create your first AR product to get started"}),!R&&(0,t.jsx)("button",{onClick:z,className:d.default.buttonPrimary,children:"create AR product"})]}),C&&(0,t.jsxs)("div",{style:{marginBottom:"24px",padding:"16px",background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"8px",fontSize:"0.9rem",color:"rgba(255, 193, 7, 0.9)"},children:[(0,t.jsxs)("p",{style:{margin:"0 0 8px 0"},children:[(0,t.jsx)("strong",{children:"AR Sessions:"})," ",C]}),(0,t.jsx)("p",{style:{margin:"0",fontSize:"0.8rem",opacity:.8},children:"The AR sessions API endpoint may require admin authentication. Set NEXT_PUBLIC_ADMIN_API_TOKEN in your environment variables to access this feature."})]}),f&&f.length>0&&(0,t.jsxs)("div",{className:d.default.arSessionsPreview,children:[(0,t.jsxs)("div",{className:d.default.sectionHeader,children:[(0,t.jsx)("h3",{className:d.default.sectionTitle,children:"recent ar sessions"}),(0,t.jsx)("button",{onClick:()=>m.push("/admin/ar-sessions"),className:d.default.viewAllButton,children:"view all"})]}),(0,t.jsx)("div",{className:d.default.arSessionsGrid,children:(f||[]).slice(0,3).map(e=>{let s=e.sessionId||e.id||"",a=e.metadata?.title||e.name||"untitled",r=e.metadata?.description||"";return(0,t.jsxs)("div",{className:d.default.arSessionCard,children:[(0,t.jsx)("h4",{className:d.default.arSessionTitle,children:a}),(0,t.jsx)("p",{className:d.default.arSessionDescription,children:r}),(0,t.jsxs)("div",{className:d.default.arSessionMeta,children:[(0,t.jsx)("span",{className:d.default.arSessionStatus,children:e.status}),(0,t.jsx)("span",{className:d.default.arSessionDate,children:new Date(e.createdAt).toLocaleDateString()})]})]},s)})})]}),(h||[]).length>0&&(0,t.jsxs)("div",{style:{marginTop:"32px",padding:"24px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"12px",backdropFilter:"blur(10px)"},children:[(0,t.jsx)("h3",{style:{color:"white",marginBottom:"16px",textAlign:"center"},children:"summary"}),(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"16px",textAlign:"center"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"600",color:"white"},children:(h||[]).length}),(0,t.jsx)("div",{style:{fontSize:"0.9rem",color:"rgba(255, 255, 255, 0.6)"},children:"total AR products"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"600",color:"white"},children:(h||[]).reduce((e,t)=>e+(t.stats?.totalClaims||0),0)}),(0,t.jsx)("div",{style:{fontSize:"0.9rem",color:"rgba(255, 255, 255, 0.6)"},children:"total claims"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"600",color:"white"},children:(h||[]).reduce((e,t)=>e+(t.stats?.remainingInventory||0),0)}),(0,t.jsx)("div",{style:{fontSize:"0.9rem",color:"rgba(255, 255, 255, 0.6)"},children:"remaining inventory"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"600",color:"white"},children:Object.values(x).reduce((e,t)=>e+t,0)||(h||[]).reduce((e,t)=>e+(t.stats?.qrCodesGenerated||0),0)}),(0,t.jsx)("div",{style:{fontSize:"0.9rem",color:"rgba(255, 255, 255, 0.6)"},children:"QR codes generated"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"600",color:"white"},children:f?f.length:0}),(0,t.jsx)("div",{style:{fontSize:"0.9rem",color:"rgba(255, 255, 255, 0.6)"},children:"ar sessions"})]})]})]}),(0,t.jsx)(o.default,{productSet:k,isOpen:_,onClose:()=>{q(!1),D(null)},onSuccess:E})]})}):null}e.s(["default",()=>c],32201)},43576,(e,t,s)=>{let a="/admin";(window.__NEXT_P=window.__NEXT_P||[]).push([a,()=>e.r(32201)]),t.hot&&t.hot.dispose(function(){window.__NEXT_P.push([a])})},48761,e=>{e.v(t=>Promise.all(["static/chunks/fd7c0943d5cd5e09.js"].map(t=>e.l(t))).then(()=>t(93594)))},28805,e=>{e.v(t=>Promise.all(["static/chunks/3dcc93bb4829c1ba.js"].map(t=>e.l(t))).then(()=>t(79466)))}]);