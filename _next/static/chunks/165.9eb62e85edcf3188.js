(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[165],{6165:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f});var n=r(5893),o=r(7294);let a="USE_DEFAULT_HIRO_PATTERN",l=[{name:"hiro",patternUrl:a,modelUrl:"/models/wmcyn_3d_logo.glb",scale:.3}];var i=r(9477),s=r(4250),d=r(7836);let c=e=>{let{mountRef:t,configs:r,setIsLoading:n}=e;(0,o.useEffect)(()=>{let e,o,l,c,u,m,f;let{THREE:h,THREEx:p}=window;if(!h||!p){console.error("three.js or ar.js (THREEx) not found on window object."),n(!1);return}let v=[],E=[],C=[],w=()=>{c&&e&&t.current&&(c.onResizeElement(),c.copyElementSizeTo(e.domElement),(null==u?void 0:u.arController)&&c.copyElementSizeTo(u.arController.canvas),t.current&&e.setSize(t.current.clientWidth,t.current.clientHeight))},A=()=>{if(f=requestAnimationFrame(A),e&&o&&l&&c&&u&&c.ready)try{u.update(c.domElement),v.forEach(e=>{e&&(o.visible=e.visible)}),e.render(o,l),C.forEach(e=>e.update(m.getDelta()))}catch(e){console.error("error during animation frame:",e)}};return(()=>{if(!t.current){console.error("mountRef.current is null in init. Aborting AR setup."),n(!1);return}(e=new i.CP7({antialias:!0,alpha:!0})).setClearColor(new s.Ilk("lightgrey"),0),e.setSize(t.current.clientWidth,t.current.clientHeight),t.current.appendChild(e.domElement),o=new s.xsS,l=new s.V1s,o.add(l),o.add(new s.Mig(0xffffff,.6));let f=new s.Ox3(0xffffff,.8);f.position.set(0,10,5),o.add(f),m=new s.SUY,(c=new p.ArToolkitSource({sourceType:"webcam",sourceWidth:640,sourceHeight:480})).init(()=>{setTimeout(()=>{w(),n(!1)},1e3)}),(u=new p.ArToolkitContext({cameraParametersUrl:p.ArToolkitContext.baseURL+"../data/data/camera_para.dat",detectionMode:"mono"})).init(()=>{u&&l&&(l.projectionMatrix.copy(u.getProjectionMatrix()),r.forEach(e=>{let t=new s.ZAu;o.add(t),v.push(t);let r=e.patternUrl;if(e.patternUrl===a){if(p.ArToolkitContext&&p.ArToolkitContext.baseURL)r=p.ArToolkitContext.baseURL+"../data/data/patt.hiro";else{console.error("THREEx.ArToolkitContext.baseURL is not available to construct default hiro pattern URL.");return}}let n=new p.ArMarkerControls(u,t,{type:"pattern",patternUrl:r,changeMatrixMode:"modelViewMatrix"});E.push(n),new d.E().load(e.modelUrl,r=>{let o=r.scene;if(o){let a=e.scale||1;if(o.scale.set(a,a,a),t.add(o),r.animations&&r.animations.length){let e=new s.Xcj(o);C.push(e),e.clipAction(r.animations[0]).play()}e.onFound&&n.addEventListener("markerFound",()=>{e.onFound&&e.onFound()})}},void 0,t=>{console.error("error loading model ".concat(e.modelUrl," for marker ").concat(e.name,":"),t)})}))}),window.addEventListener("resize",w),A()})(),()=>{var r,n,a,l;cancelAnimationFrame(f),window.removeEventListener("resize",w),C.forEach(e=>{}),C.length=0,v.forEach(e=>{null==o||o.remove(e),e.traverse(e=>{if(e instanceof s.Kj0){var t,r;null===(t=e.geometry)||void 0===t||t.dispose(),Array.isArray(e.material)?e.material.forEach(e=>e.dispose()):null===(r=e.material)||void 0===r||r.dispose()}})}),v.length=0,E.length=0,null==c||null===(r=c.domElement)||void 0===r||r.remove(),null==c||null===(n=c.destroy)||void 0===n||n.call(c),null==u||null===(l=u.arController)||void 0===l||null===(a=l.dispose)||void 0===a||a.call(l),null==e||e.dispose(),t.current&&(null==e?void 0:e.domElement)&&t.current.contains(e.domElement)&&t.current.removeChild(e.domElement)}},[t,r,n])};var u=r(2567),m=r.n(u);let f=e=>{let{onClose:t,configs:r=l}=e,a=(0,o.useRef)(null),[i,s]=(0,o.useState)(!0);return c({mountRef:a,configs:r,setIsLoading:s}),o.useEffect(()=>(document.body.classList.add("cameraActive"),()=>{document.body.classList.remove("cameraActive")}),[]),(0,n.jsxs)("div",{className:m().arCameraContainer,children:[i&&(0,n.jsx)("div",{className:m().loadingOverlay,children:"Initializing AR..."}),(0,n.jsx)("div",{ref:a,className:m().mountPoint}),(0,n.jsx)("button",{onClick:t,className:m().closeButton,children:"Close AR"})]})}},2567:e=>{e.exports={arCameraContainer:"ARCamera_arCameraContainer__jxoSI",loadingOverlay:"ARCamera_loadingOverlay__FsDdX",mountPoint:"ARCamera_mountPoint__oeW3w",closeButton:"ARCamera_closeButton__FiWl_"}}}]);