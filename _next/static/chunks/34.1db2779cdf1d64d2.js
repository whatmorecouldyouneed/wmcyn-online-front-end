(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[34],{4034:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>R});var o=a(5893),n=a(7294);let i="USE_DEFAULT_HIRO_PATTERN",l=[{name:"hiro",patternUrl:i,modelUrl:"/models/wmcyn_3d_logo.glb",scale:.3,metadata:{id:"wmcyn-tote-001",title:"wmcyn charred holographic logo tote (sample)",description:"premium canvas tote bag with embroidered wmcyn logo",printDate:"2025-04-18",printLocation:"atlanta, ga",quantity:1,price:{amount:"priceless",currencyCode:"USD"},isClaimed:!0,claimedBy:"previous_user@example.com",claimedAt:"2025-07-27T10:30:00Z"}}];var r=a(9477),s=a(4250),d=a(7836);let c=e=>{let{mountRef:t,configs:a,setIsLoading:o}=e;(0,n.useEffect)(()=>{let e,n,l,c,m,h,u;let p=t.current,{THREE:y,THREEx:g}=window;if(!y||!g){console.error("three.js or ar.js (THREEx) not found on window object."),o(!1);return}let v=[],w=[],f=[],b=()=>{c&&e&&t.current&&(c.onResizeElement(),c.copyElementSizeTo(e.domElement),(null==m?void 0:m.arController)&&c.copyElementSizeTo(m.arController.canvas),t.current&&e.setSize(t.current.clientWidth,t.current.clientHeight))},_=()=>{if(u=requestAnimationFrame(_),e&&n&&l&&c&&m&&c.ready)try{m.update(c.domElement),v.forEach(e=>{e&&(n.visible=e.visible)}),e.render(n,l),f.forEach(e=>e.update(h.getDelta()))}catch(e){console.error("error during animation frame:",e)}};return(()=>{if(!t.current){console.error("mountRef.current is null in init. Aborting AR setup."),o(!1);return}(e=new r.CP7({antialias:!0,alpha:!0,preserveDrawingBuffer:!1,powerPreference:"high-performance"})).setClearColor(new s.Ilk(0),0),e.setSize(window.innerWidth,window.innerHeight),e.domElement.style.position="absolute",e.domElement.style.top="0px",e.domElement.style.left="0px",e.domElement.style.right="0px",e.domElement.style.bottom="0px",e.domElement.style.width="100vw",e.domElement.style.height="100vh",e.domElement.style.zIndex="2",t.current.appendChild(e.domElement),n=new s.xsS,l=new s.V1s,n.add(l),n.add(new s.Mig(0xffffff,.6));let u=new s.Ox3(0xffffff,.8);u.position.set(0,10,5),n.add(u),h=new s.SUY;let p=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);(c=new g.ArToolkitSource({sourceType:"webcam",sourceWidth:p?480:640,sourceHeight:p?320:480,facingMode:p?"environment":"user"})).init(()=>{console.log("ArToolkitSource initialized successfully"),c.domElement?(console.log("Video element found:",c.domElement),c.domElement.style.position="absolute",c.domElement.style.top="0px",c.domElement.style.left="0px",c.domElement.style.right="0px",c.domElement.style.bottom="0px",c.domElement.style.width="100vw",c.domElement.style.height="100vh",c.domElement.style.maxWidth="100vw",c.domElement.style.maxHeight="100vh",c.domElement.style.minWidth="100vw",c.domElement.style.minHeight="100vh",c.domElement.style.margin="0",c.domElement.style.padding="0",c.domElement.style.boxSizing="border-box",c.domElement.style.zIndex="1",c.domElement.style.objectFit="cover",c.domElement.style.display="block",c.domElement.setAttribute("playsinline","true"),c.domElement.setAttribute("webkit-playsinline","true"),c.domElement.setAttribute("autoplay","true"),c.domElement.setAttribute("muted","true"),t.current&&!t.current.contains(c.domElement)&&t.current.appendChild(c.domElement)):console.error("No video element created by ArToolkitSource"),setTimeout(()=>{if(c&&c.ready){var e,t;b(),o(!1),console.log("AR Scene ready with video dimensions:",{videoWidth:null===(e=c.domElement)||void 0===e?void 0:e.videoWidth,videoHeight:null===(t=c.domElement)||void 0===t?void 0:t.videoHeight,ready:c.ready})}else console.warn("ArToolkitSource not ready after timeout"),o(!1)},2e3)},e=>{console.error("ArToolkitSource initialization failed:",e),o(!1)}),(m=new g.ArToolkitContext({cameraParametersUrl:g.ArToolkitContext.baseURL+"../data/data/camera_para.dat",detectionMode:"mono",matrixCodeType:"3x3",canvasWidth:640,canvasHeight:480,imageSmoothingEnabled:!1})).init(()=>{m&&l&&(l.projectionMatrix.copy(m.getProjectionMatrix()),a.forEach(e=>{let t=new s.ZAu;n.add(t),v.push(t);let a=e.patternUrl;if(e.patternUrl===i){if(g.ArToolkitContext&&g.ArToolkitContext.baseURL)a=g.ArToolkitContext.baseURL+"../data/data/patt.hiro";else{console.error("THREEx.ArToolkitContext.baseURL is not available to construct default hiro pattern URL.");return}}let o=new g.ArMarkerControls(m,t,{type:"pattern",patternUrl:a,changeMatrixMode:"modelViewMatrix"});w.push(o),new d.E().load(e.modelUrl,a=>{let n=a.scene;if(n){let i=e.scale||1;if(n.scale.set(i,i,i),t.add(n),a.animations&&a.animations.length){let e=new s.Xcj(n);f.push(e),e.clipAction(a.animations[0]).play()}e.onFound&&o.addEventListener("markerFound",()=>{e.onFound&&e.onFound()})}},void 0,t=>{console.error("error loading model ".concat(e.modelUrl," for marker ").concat(e.name,":"),t)})}))}),window.addEventListener("resize",b),_()})(),()=>{var t,a,o,i;cancelAnimationFrame(u),window.removeEventListener("resize",b),f.forEach(e=>{}),f.length=0,v.forEach(e=>{null==n||n.remove(e),e.traverse(e=>{if(e instanceof s.Kj0){var t,a;null===(t=e.geometry)||void 0===t||t.dispose(),Array.isArray(e.material)?e.material.forEach(e=>e.dispose()):null===(a=e.material)||void 0===a||a.dispose()}})}),v.length=0,w.length=0,null==c||null===(t=c.domElement)||void 0===t||t.remove(),null==c||null===(a=c.destroy)||void 0===a||a.call(c),null==m||null===(i=m.arController)||void 0===i||null===(o=i.dispose)||void 0===o||o.call(i),null==e||e.dispose(),p&&(null==e?void 0:e.domElement)&&p.contains(e.domElement)&&p.removeChild(e.domElement)}},[t,a,o])};var m=a(7146),h=a.n(m);let u=e=>{let{metadata:t,isVisible:a,onClaim:n,onShare:i,onPurchase:l}=e,r=(e,t)=>"".concat("USD"===t?"$":t).concat(e);return t?(0,o.jsx)("div",{className:"".concat(h().overlay," ").concat(a?"":h().fadeOut),children:(0,o.jsxs)("div",{className:h().container,children:[(0,o.jsxs)("div",{className:h().header,children:[(0,o.jsx)("h3",{className:h().title,children:t.title}),(0,o.jsx)("div",{className:h().status,children:t.isClaimed?(0,o.jsx)("span",{className:h().claimed,children:"✓ claimed"}):(0,o.jsx)("span",{className:h().available,children:"● available"})})]}),(0,o.jsxs)("div",{className:h().metadata,children:[(0,o.jsxs)("div",{className:h().metadataRow,children:[(0,o.jsx)("span",{className:h().label,children:"printed:"}),(0,o.jsx)("span",{className:h().value,children:new Date(t.printDate).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]}),(0,o.jsxs)("div",{className:h().metadataRow,children:[(0,o.jsx)("span",{className:h().label,children:"location:"}),(0,o.jsx)("span",{className:h().value,children:t.printLocation})]}),(0,o.jsxs)("div",{className:h().metadataRow,children:[(0,o.jsx)("span",{className:h().label,children:"edition:"}),(0,o.jsxs)("span",{className:h().value,children:[t.quantity," pieces"]})]}),(0,o.jsxs)("div",{className:h().metadataRow,children:[(0,o.jsx)("span",{className:h().label,children:"price:"}),(0,o.jsx)("span",{className:h().value,children:r(t.price.amount,t.price.currencyCode)})]})]}),t.description&&(0,o.jsx)("p",{className:h().description,children:t.description}),(0,o.jsxs)("div",{className:h().actions,children:[!t.isClaimed&&n&&(0,o.jsx)("button",{className:h().claimButton,onClick:n,children:"claim"}),(0,o.jsxs)("button",{className:h().purchaseButton,disabled:!0,children:["buy ",r(t.price.amount,t.price.currencyCode)]}),i&&(0,o.jsx)("button",{className:h().shareButton,onClick:i,children:"\uD83D\uDCF8"})]})]})}):null},p={CUSTOM_URL_SCHEME:"instagram://story-camera",FACEBOOK_APP_ID:"your_facebook_app_id_here",FALLBACK_URL:"https://instagram.com"},y=()=>{let e=navigator.userAgent.toLowerCase(),t=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(e);return{isMobile:t,isIOS:/ipad|iphone|ipod/.test(e),isAndroid:/android/.test(e),supportsWebShare:"share"in navigator&&"function"==typeof navigator.share}},g=e=>new Promise((t,a)=>{let o=new FileReader;o.onload=()=>{"string"==typeof o.result?t(o.result.split(",")[1]):a(Error("Failed to convert blob to base64"))},o.onerror=a,o.readAsDataURL(e)}),v=async e=>{let{backgroundImage:t,stickerImage:a,backgroundTopColor:o,backgroundBottomColor:n}=e;try{let e="".concat(p.CUSTOM_URL_SCHEME,"?source_application=").concat(p.FACEBOOK_APP_ID);if(!await new Promise(t=>{let a=document.createElement("iframe");a.style.display="none",a.src=e;let o=setTimeout(()=>{t(!1),document.body.removeChild(a)},2e3);a.onload=()=>{clearTimeout(o),t(!0),document.body.removeChild(a)},document.body.appendChild(a)}))throw Error("Instagram app not available");let i={};return t&&(i["com.instagram.sharedSticker.backgroundImage"]=await g(t)),a&&(i["com.instagram.sharedSticker.stickerImage"]=await g(a)),o&&(i["com.instagram.sharedSticker.backgroundTopColor"]=o),n&&(i["com.instagram.sharedSticker.backgroundBottomColor"]=n),localStorage.setItem("instagram_share_data",JSON.stringify(i)),window.location.href=e,!0}catch(e){return console.error("iOS Instagram sharing failed:",e),!1}},w=async e=>{let{backgroundImage:t,text:a,url:o}=e;try{if("intent://".concat("com.instagram.share.ADD_TO_STORY","#Intent;package=com.instagram.android;scheme=https;S.source_application=").concat(p.FACEBOOK_APP_ID,";end"),navigator.share&&t){let e={files:[new File([t],"wmcyn-ar-experience.png",{type:"image/png"})],title:"WMCYN AR Experience",text:a||"Check out this amazing AR experience!",url:o};if(navigator.canShare&&navigator.canShare(e))return await navigator.share(e),!0}let e="instagram://story-camera?source_application=".concat(p.FACEBOOK_APP_ID);return window.location.href=e,setTimeout(()=>{window.open(p.FALLBACK_URL,"_blank")},2e3),!0}catch(e){return console.error("Android Instagram sharing failed:",e),!1}},f=async e=>{let t=y(),{backgroundImage:a,text:o,url:n}=e;if(t.isMobile)try{if(t.isIOS){if(await v(e))return{success:!0,method:"ios_custom_url_scheme",message:"Opening Instagram app..."}}else if(t.isAndroid&&await w(e))return{success:!0,method:"android_intent",message:"Opening Instagram app..."}}catch(e){console.warn("Native app sharing failed, trying web methods")}if(t.supportsWebShare&&a)try{let e={files:[new File([a],"wmcyn-ar-experience.png",{type:"image/png"})],title:"WMCYN AR Experience",text:o||"Check out this amazing AR experience!",url:n};if(navigator.canShare&&navigator.canShare(e))return await navigator.share(e),{success:!0,method:"web_share_api_with_file",message:"Shared successfully!"}}catch(e){console.warn("Web Share API with file failed")}if(t.supportsWebShare)try{return await navigator.share({title:"WMCYN AR Experience",text:o||"Check out this amazing AR experience!",url:n||"https://wmcyn.online"}),{success:!0,method:"web_share_api_text",message:"Shared successfully!"}}catch(e){console.warn("Web Share API text sharing failed")}if(a)try{let e=URL.createObjectURL(a),t=document.createElement("a");t.href=e,t.download="wmcyn-ar-experience.png",document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(e);let i="".concat(o||"Check out this amazing WMCYN AR experience!"," ").concat(n||"https://wmcyn.online");return await navigator.clipboard.writeText(i),{success:!0,method:"download_and_copy",message:"Image downloaded! Share text copied to clipboard. Upload to your Instagram Story and paste the text."}}catch(e){console.warn("Download method failed")}try{let e=n||"https://wmcyn.online";return await navigator.clipboard.writeText(e),{success:!0,method:"copy_url_fallback",message:"Link copied to clipboard! Share it manually on Instagram Story."}}catch(t){let e=n||"https://wmcyn.online";return{success:!1,method:"manual_fallback",message:"Please copy this link manually: ".concat(e)}}},b=async e=>{try{console.log("Capturing AR scene for Instagram story...");let t=document.createElement("canvas"),a=t.getContext("2d");if(!a)throw Error("Could not get canvas context");if(t.width=1080,t.height=1920,a.fillStyle="#000000",a.fillRect(0,0,t.width,t.height),e.videoElement&&e.videoElement.videoWidth>0){let o,n,i,l;let r=e.videoElement.videoWidth/e.videoElement.videoHeight,s=t.width/t.height;r>s?(o=(n=t.height)*r,i=(t.width-o)/2,l=0):(n=(o=t.width)/r,i=0,l=(t.height-n)/2),a.drawImage(e.videoElement,i,l,o,n)}if(e.canvasElement){let o,n,i,l;let r=e.canvasElement.width/e.canvasElement.height,s=t.width/t.height;r>s?(o=(n=t.height)*r,i=(t.width-o)/2,l=0):(n=(o=t.width)/r,i=0,l=(t.height-n)/2),a.globalCompositeOperation="source-over",a.drawImage(e.canvasElement,i,l,o,n)}return await _(a,t,e.metadata),new Promise(e=>{t.toBlob(t=>{e(t)},"image/jpeg",.95)})}catch(e){return console.error("Error capturing AR scene:",e),null}},_=async(e,t,a)=>{let o=t.height-300-60,n=e.createLinearGradient(0,o,0,o+300);n.addColorStop(0,"rgba(0, 0, 0, 0.8)"),n.addColorStop(1,"rgba(0, 0, 0, 0.95)"),e.fillStyle=n,e.fillRect(60,o,t.width-120,300),e.strokeStyle="rgba(255, 255, 255, 0.2)",e.lineWidth=2,e.strokeRect(60,o,t.width-120,300),e.fillStyle="#ffffff",e.font="bold 48px Arial",e.textAlign="center",e.fillText("WMCYN",t.width/2,o+60),e.font="bold 64px Arial",e.fillStyle="#ffffff",e.textAlign="center",e.fillText(a.title.toUpperCase(),t.width/2,o+130);let i="".concat("USD"===a.price.currencyCode?"$":a.price.currencyCode).concat(a.price.amount);e.font="42px Arial",e.fillStyle="#10b981",e.textAlign="left",e.fillText(i,100,o+190),e.fillStyle="#ffffff",e.textAlign="right",e.fillText(a.printLocation,t.width-60-40,o+190),e.font="36px Arial",e.fillStyle="rgba(255, 255, 255, 0.8)",e.textAlign="center",e.fillText("LIMITED EDITION • ".concat(a.quantity," PIECES"),t.width/2,o+240),e.font="32px Arial",e.fillStyle="rgba(255, 255, 255, 0.7)",e.textAlign="center",e.fillText("SCAN WMCYN QR CODE TO EXPERIENCE IN AR",t.width/2,o+280)},E=async e=>{try{console.log("Sharing AR scene to Instagram...",e.metadata);let t=await b(e);if(!t)throw Error("Failed to capture AR scene");y().isMobile?await f({backgroundImage:t}):(A(t,"wmcyn-ar-".concat(e.metadata.id,".jpg")),alert("Image saved! Please upload this image to your Instagram story manually."))}catch(e){console.error("Error sharing to Instagram:",e),window.open("https://instagram.com","_blank")}},A=(e,t)=>{let a=URL.createObjectURL(e),o=document.createElement("a");o.href=a,o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)};var x=a(2567),C=a.n(x);let R=e=>{let{onClose:t,configs:a=l}=e,i=(0,n.useRef)(null),[r,s]=(0,n.useState)(!0),[d,m]=(0,n.useState)(null),[h,p]=(0,n.useState)(!1),y=(0,n.useRef)(null),g=(0,n.useRef)(0);n.useEffect(()=>{console.log("ARCamera: Loading state changed to:",r)},[r]);let v=(0,n.useCallback)(e=>{var t;let a=Date.now();g.current=a,console.log("Marker detected: ".concat(e.name)),h?(null==d?void 0:d.name)!==e.name&&m(e):(m(e),p(!0)),y.current&&(clearTimeout(y.current),y.current=null),y.current=setTimeout(()=>{Date.now()-g.current>=2e3&&(console.log("Hiding metadata after 2 seconds of no detection"),p(!1),setTimeout(()=>{m(null)},200))},2e3),null===(t=e.onFound)||void 0===t||t.call(e)},[h,d]);c({mountRef:i,configs:(0,n.useMemo)(()=>a.map(e=>({...e,onFound:()=>v(e)})),[a,v]),setIsLoading:s}),n.useEffect(()=>{console.log("ARCamera: Adding cameraActive classes and applying body styles"),document.body.classList.add("cameraActive"),document.documentElement.classList.add("cameraActive");let e=document.documentElement,t=document.body,a={htmlOverflow:e.style.overflow,htmlWidth:e.style.width,htmlHeight:e.style.height,bodyOverflow:t.style.overflow,bodyPosition:t.style.position,bodyWidth:t.style.width,bodyHeight:t.style.height,bodyLeft:t.style.left,bodyTop:t.style.top,bodyMargin:t.style.margin,bodyPadding:t.style.padding};e.style.overflow="hidden",e.style.width="100vw",e.style.height="100vh",t.style.overflow="hidden",t.style.position="fixed",t.style.width="100vw",t.style.height="100vh",t.style.left="0",t.style.top="0",t.style.margin="0",t.style.padding="0",window.scrollTo(0,1);let o=()=>{setTimeout(()=>{if(window.scrollTo(0,1),i.current){let e=new Event("resize");window.dispatchEvent(e)}},100)};return window.addEventListener("orientationchange",o),window.addEventListener("resize",o),()=>{document.body.classList.remove("cameraActive"),document.documentElement.classList.remove("cameraActive"),y.current&&(clearTimeout(y.current),y.current=null);let e=document.documentElement,t=document.body;e.style.overflow=a.htmlOverflow,e.style.width=a.htmlWidth,e.style.height=a.htmlHeight,t.style.overflow=a.bodyOverflow,t.style.position=a.bodyPosition,t.style.width=a.bodyWidth,t.style.height=a.bodyHeight,t.style.left=a.bodyLeft,t.style.top=a.bodyTop,t.style.margin=a.bodyMargin,t.style.padding=a.bodyPadding,window.removeEventListener("orientationchange",o),window.removeEventListener("resize",o)}},[]);let w=async()=>{if(null==d?void 0:d.metadata){console.log("Sharing product:",d.metadata.id);try{var e,t;let a=null===(e=i.current)||void 0===e?void 0:e.querySelector("video"),o=null===(t=i.current)||void 0===t?void 0:t.querySelector("canvas");await E({metadata:{id:d.metadata.id,title:d.metadata.title,price:d.metadata.price,printLocation:d.metadata.printLocation,quantity:d.metadata.quantity},videoElement:a,canvasElement:o})}catch(e){console.error("Error sharing to Instagram:",e),alert("Failed to share to Instagram. Please try again.")}}};return(0,o.jsxs)("div",{className:C().arCameraContainer,children:[(0,o.jsx)("div",{ref:i,className:C().mountPoint}),r&&(0,o.jsx)("div",{className:C().loadingOverlay,children:"Initializing AR..."}),(null==d?void 0:d.metadata)&&(0,o.jsx)(u,{metadata:d.metadata,isVisible:h,onClaim:()=>{(null==d?void 0:d.metadata)&&console.log("Claiming product:",d.metadata.id)},onPurchase:()=>{(null==d?void 0:d.metadata)&&console.log("Purchasing product:",d.metadata.id)},onShare:w}),(0,o.jsx)("button",{onClick:t,className:C().closeButton,children:"Close AR"})]})}},2567:e=>{e.exports={arCameraContainer:"ARCamera_arCameraContainer__jxoSI",mountPoint:"ARCamera_mountPoint__oeW3w",loadingOverlay:"ARCamera_loadingOverlay__FsDdX",closeButton:"ARCamera_closeButton__FiWl_"}},7146:e=>{e.exports={overlay:"ARMetadataOverlay_overlay__FcBFd",slideUp:"ARMetadataOverlay_slideUp__S_Kr9",fadeOut:"ARMetadataOverlay_fadeOut__bh4yh",container:"ARMetadataOverlay_container__7m8MR",header:"ARMetadataOverlay_header__OM29E",title:"ARMetadataOverlay_title__7S_B3",status:"ARMetadataOverlay_status__AstsA",claimed:"ARMetadataOverlay_claimed__oj4xj",available:"ARMetadataOverlay_available__M1vQK",metadata:"ARMetadataOverlay_metadata__AL9kC",metadataRow:"ARMetadataOverlay_metadataRow__UthtV",label:"ARMetadataOverlay_label__t_umT",value:"ARMetadataOverlay_value__QGI3m",description:"ARMetadataOverlay_description__c_by_",actions:"ARMetadataOverlay_actions__7oO47",claimButton:"ARMetadataOverlay_claimButton__hPcVl",purchaseButton:"ARMetadataOverlay_purchaseButton__d9OIC",shareButton:"ARMetadataOverlay_shareButton__RL2Qf"}}}]);