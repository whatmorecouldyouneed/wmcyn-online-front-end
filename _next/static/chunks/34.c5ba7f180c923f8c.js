(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[34],{4034:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>R});var n=a(5893),r=a(7294);let o="USE_DEFAULT_HIRO_PATTERN",i=[{name:"hiro",patternUrl:o,modelUrl:"/models/wmcyn_3d_logo.glb",scale:.3,metadata:{id:"wmcyn-tote-001",title:"wmcyn charred holographic logo tote (sample)",description:"premium canvas tote bag with embroidered wmcyn logo",printDate:"2025-04-18",printLocation:"atlanta, ga",quantity:1,price:{amount:"priceless",currencyCode:"USD"},isClaimed:!0,claimedBy:"previous_user@example.com",claimedAt:"2025-07-27T10:30:00Z"}}];var l=a(9477),s=a(4250),c=a(7836);let d=e=>{let{mountRef:t,configs:a,setIsLoading:n}=e;(0,r.useEffect)(()=>{let e,r,i,d,m,h,u;let p=t.current,{THREE:g,THREEx:y}=window;if(!g||!y){console.error("three.js or ar.js (THREEx) not found on window object."),n(!1);return}let v=[],f=[],w=[],_=()=>{d&&e&&t.current&&(d.onResizeElement(),d.copyElementSizeTo(e.domElement),(null==m?void 0:m.arController)&&d.copyElementSizeTo(m.arController.canvas),t.current&&e.setSize(t.current.clientWidth,t.current.clientHeight))},b=()=>{if(u=requestAnimationFrame(b),e&&r&&i&&d&&m&&d.ready)try{m.update(d.domElement),v.forEach(e=>{e&&(r.visible=e.visible)}),e.render(r,i),w.forEach(e=>e.update(h.getDelta()))}catch(e){console.error("error during animation frame:",e)}};return(()=>{if(!t.current){console.error("mountRef.current is null in init. Aborting AR setup."),n(!1);return}(e=new l.CP7({antialias:!0,alpha:!0})).setClearColor(new s.Ilk("lightgrey"),0),e.setSize(t.current.clientWidth,t.current.clientHeight),t.current.appendChild(e.domElement),r=new s.xsS,i=new s.V1s,r.add(i),r.add(new s.Mig(0xffffff,.6));let u=new s.Ox3(0xffffff,.8);u.position.set(0,10,5),r.add(u),h=new s.SUY,(d=new y.ArToolkitSource({sourceType:"webcam",sourceWidth:640,sourceHeight:480})).init(()=>{setTimeout(()=>{_(),n(!1)},1e3)}),(m=new y.ArToolkitContext({cameraParametersUrl:y.ArToolkitContext.baseURL+"../data/data/camera_para.dat",detectionMode:"mono"})).init(()=>{m&&i&&(i.projectionMatrix.copy(m.getProjectionMatrix()),a.forEach(e=>{let t=new s.ZAu;r.add(t),v.push(t);let a=e.patternUrl;if(e.patternUrl===o){if(y.ArToolkitContext&&y.ArToolkitContext.baseURL)a=y.ArToolkitContext.baseURL+"../data/data/patt.hiro";else{console.error("THREEx.ArToolkitContext.baseURL is not available to construct default hiro pattern URL.");return}}let n=new y.ArMarkerControls(m,t,{type:"pattern",patternUrl:a,changeMatrixMode:"modelViewMatrix"});f.push(n),new c.E().load(e.modelUrl,a=>{let r=a.scene;if(r){let o=e.scale||1;if(r.scale.set(o,o,o),t.add(r),a.animations&&a.animations.length){let e=new s.Xcj(r);w.push(e),e.clipAction(a.animations[0]).play()}e.onFound&&n.addEventListener("markerFound",()=>{e.onFound&&e.onFound()})}},void 0,t=>{console.error("error loading model ".concat(e.modelUrl," for marker ").concat(e.name,":"),t)})}))}),window.addEventListener("resize",_),b()})(),()=>{var t,a,n,o;cancelAnimationFrame(u),window.removeEventListener("resize",_),w.forEach(e=>{}),w.length=0,v.forEach(e=>{null==r||r.remove(e),e.traverse(e=>{if(e instanceof s.Kj0){var t,a;null===(t=e.geometry)||void 0===t||t.dispose(),Array.isArray(e.material)?e.material.forEach(e=>e.dispose()):null===(a=e.material)||void 0===a||a.dispose()}})}),v.length=0,f.length=0,null==d||null===(t=d.domElement)||void 0===t||t.remove(),null==d||null===(a=d.destroy)||void 0===a||a.call(d),null==m||null===(o=m.arController)||void 0===o||null===(n=o.dispose)||void 0===n||n.call(o),null==e||e.dispose(),p&&(null==e?void 0:e.domElement)&&p.contains(e.domElement)&&p.removeChild(e.domElement)}},[t,a,n])};var m=a(7146),h=a.n(m);let u=e=>{let{metadata:t,isVisible:a,onClaim:r,onShare:o,onPurchase:i}=e,l=(e,t)=>"".concat("USD"===t?"$":t).concat(e);return t?(0,n.jsx)("div",{className:"".concat(h().overlay," ").concat(a?"":h().fadeOut),children:(0,n.jsxs)("div",{className:h().container,children:[(0,n.jsxs)("div",{className:h().header,children:[(0,n.jsx)("h3",{className:h().title,children:t.title}),(0,n.jsx)("div",{className:h().status,children:t.isClaimed?(0,n.jsx)("span",{className:h().claimed,children:"✓ claimed"}):(0,n.jsx)("span",{className:h().available,children:"● available"})})]}),(0,n.jsxs)("div",{className:h().metadata,children:[(0,n.jsxs)("div",{className:h().metadataRow,children:[(0,n.jsx)("span",{className:h().label,children:"printed:"}),(0,n.jsx)("span",{className:h().value,children:new Date(t.printDate).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]}),(0,n.jsxs)("div",{className:h().metadataRow,children:[(0,n.jsx)("span",{className:h().label,children:"location:"}),(0,n.jsx)("span",{className:h().value,children:t.printLocation})]}),(0,n.jsxs)("div",{className:h().metadataRow,children:[(0,n.jsx)("span",{className:h().label,children:"edition:"}),(0,n.jsxs)("span",{className:h().value,children:[t.quantity," pieces"]})]}),(0,n.jsxs)("div",{className:h().metadataRow,children:[(0,n.jsx)("span",{className:h().label,children:"price:"}),(0,n.jsx)("span",{className:h().value,children:l(t.price.amount,t.price.currencyCode)})]})]}),t.description&&(0,n.jsx)("p",{className:h().description,children:t.description}),(0,n.jsxs)("div",{className:h().actions,children:[!t.isClaimed&&r&&(0,n.jsx)("button",{className:h().claimButton,onClick:r,children:"claim"}),(0,n.jsxs)("button",{className:h().purchaseButton,disabled:!0,children:["buy ",l(t.price.amount,t.price.currencyCode)]}),o&&(0,n.jsx)("button",{className:h().shareButton,onClick:o,children:"\uD83D\uDCF8"})]})]})}):null},p={CUSTOM_URL_SCHEME:"instagram://story-camera",FACEBOOK_APP_ID:"your_facebook_app_id_here",FALLBACK_URL:"https://instagram.com"},g=()=>{let e=navigator.userAgent.toLowerCase(),t=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(e);return{isMobile:t,isIOS:/ipad|iphone|ipod/.test(e),isAndroid:/android/.test(e),supportsWebShare:"share"in navigator&&"function"==typeof navigator.share}},y=e=>new Promise((t,a)=>{let n=new FileReader;n.onload=()=>{"string"==typeof n.result?t(n.result.split(",")[1]):a(Error("Failed to convert blob to base64"))},n.onerror=a,n.readAsDataURL(e)}),v=async e=>{let{backgroundImage:t,stickerImage:a,backgroundTopColor:n,backgroundBottomColor:r}=e;try{let e="".concat(p.CUSTOM_URL_SCHEME,"?source_application=").concat(p.FACEBOOK_APP_ID);if(!await new Promise(t=>{let a=document.createElement("iframe");a.style.display="none",a.src=e;let n=setTimeout(()=>{t(!1),document.body.removeChild(a)},2e3);a.onload=()=>{clearTimeout(n),t(!0),document.body.removeChild(a)},document.body.appendChild(a)}))throw Error("Instagram app not available");let o={};return t&&(o["com.instagram.sharedSticker.backgroundImage"]=await y(t)),a&&(o["com.instagram.sharedSticker.stickerImage"]=await y(a)),n&&(o["com.instagram.sharedSticker.backgroundTopColor"]=n),r&&(o["com.instagram.sharedSticker.backgroundBottomColor"]=r),localStorage.setItem("instagram_share_data",JSON.stringify(o)),window.location.href=e,!0}catch(e){return console.error("iOS Instagram sharing failed:",e),!1}},f=async e=>{let{backgroundImage:t,text:a,url:n}=e;try{if("intent://".concat("com.instagram.share.ADD_TO_STORY","#Intent;package=com.instagram.android;scheme=https;S.source_application=").concat(p.FACEBOOK_APP_ID,";end"),navigator.share&&t){let e={files:[new File([t],"wmcyn-ar-experience.png",{type:"image/png"})],title:"WMCYN AR Experience",text:a||"Check out this amazing AR experience!",url:n};if(navigator.canShare&&navigator.canShare(e))return await navigator.share(e),!0}let e="instagram://story-camera?source_application=".concat(p.FACEBOOK_APP_ID);return window.location.href=e,setTimeout(()=>{window.open(p.FALLBACK_URL,"_blank")},2e3),!0}catch(e){return console.error("Android Instagram sharing failed:",e),!1}},w=async e=>{let t=g(),{backgroundImage:a,text:n,url:r}=e;if(t.isMobile)try{if(t.isIOS){if(await v(e))return{success:!0,method:"ios_custom_url_scheme",message:"Opening Instagram app..."}}else if(t.isAndroid&&await f(e))return{success:!0,method:"android_intent",message:"Opening Instagram app..."}}catch(e){console.warn("Native app sharing failed, trying web methods")}if(t.supportsWebShare&&a)try{let e={files:[new File([a],"wmcyn-ar-experience.png",{type:"image/png"})],title:"WMCYN AR Experience",text:n||"Check out this amazing AR experience!",url:r};if(navigator.canShare&&navigator.canShare(e))return await navigator.share(e),{success:!0,method:"web_share_api_with_file",message:"Shared successfully!"}}catch(e){console.warn("Web Share API with file failed")}if(t.supportsWebShare)try{return await navigator.share({title:"WMCYN AR Experience",text:n||"Check out this amazing AR experience!",url:r||"https://wmcyn.online"}),{success:!0,method:"web_share_api_text",message:"Shared successfully!"}}catch(e){console.warn("Web Share API text sharing failed")}if(a)try{let e=URL.createObjectURL(a),t=document.createElement("a");t.href=e,t.download="wmcyn-ar-experience.png",document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(e);let o="".concat(n||"Check out this amazing WMCYN AR experience!"," ").concat(r||"https://wmcyn.online");return await navigator.clipboard.writeText(o),{success:!0,method:"download_and_copy",message:"Image downloaded! Share text copied to clipboard. Upload to your Instagram Story and paste the text."}}catch(e){console.warn("Download method failed")}try{let e=r||"https://wmcyn.online";return await navigator.clipboard.writeText(e),{success:!0,method:"copy_url_fallback",message:"Link copied to clipboard! Share it manually on Instagram Story."}}catch(t){let e=r||"https://wmcyn.online";return{success:!1,method:"manual_fallback",message:"Please copy this link manually: ".concat(e)}}},_=async e=>{try{console.log("Capturing AR scene for Instagram story...");let t=document.createElement("canvas"),a=t.getContext("2d");if(!a)throw Error("Could not get canvas context");if(t.width=1080,t.height=1920,a.fillStyle="#000000",a.fillRect(0,0,t.width,t.height),e.videoElement&&e.videoElement.videoWidth>0){let n,r,o,i;let l=e.videoElement.videoWidth/e.videoElement.videoHeight,s=t.width/t.height;l>s?(n=(r=t.height)*l,o=(t.width-n)/2,i=0):(r=(n=t.width)/l,o=0,i=(t.height-r)/2),a.drawImage(e.videoElement,o,i,n,r)}if(e.canvasElement){let n,r,o,i;let l=e.canvasElement.width/e.canvasElement.height,s=t.width/t.height;l>s?(n=(r=t.height)*l,o=(t.width-n)/2,i=0):(r=(n=t.width)/l,o=0,i=(t.height-r)/2),a.globalCompositeOperation="source-over",a.drawImage(e.canvasElement,o,i,n,r)}return await b(a,t,e.metadata),new Promise(e=>{t.toBlob(t=>{e(t)},"image/jpeg",.95)})}catch(e){return console.error("Error capturing AR scene:",e),null}},b=async(e,t,a)=>{let n=t.height-300-60,r=e.createLinearGradient(0,n,0,n+300);r.addColorStop(0,"rgba(0, 0, 0, 0.8)"),r.addColorStop(1,"rgba(0, 0, 0, 0.95)"),e.fillStyle=r,e.fillRect(60,n,t.width-120,300),e.strokeStyle="rgba(255, 255, 255, 0.2)",e.lineWidth=2,e.strokeRect(60,n,t.width-120,300),e.fillStyle="#ffffff",e.font="bold 48px Arial",e.textAlign="center",e.fillText("WMCYN",t.width/2,n+60),e.font="bold 64px Arial",e.fillStyle="#ffffff",e.textAlign="center",e.fillText(a.title.toUpperCase(),t.width/2,n+130);let o="".concat("USD"===a.price.currencyCode?"$":a.price.currencyCode).concat(a.price.amount);e.font="42px Arial",e.fillStyle="#10b981",e.textAlign="left",e.fillText(o,100,n+190),e.fillStyle="#ffffff",e.textAlign="right",e.fillText(a.printLocation,t.width-60-40,n+190),e.font="36px Arial",e.fillStyle="rgba(255, 255, 255, 0.8)",e.textAlign="center",e.fillText("LIMITED EDITION • ".concat(a.quantity," PIECES"),t.width/2,n+240),e.font="32px Arial",e.fillStyle="rgba(255, 255, 255, 0.7)",e.textAlign="center",e.fillText("SCAN WMCYN QR CODE TO EXPERIENCE IN AR",t.width/2,n+280)},A=async e=>{try{console.log("Sharing AR scene to Instagram...",e.metadata);let t=await _(e);if(!t)throw Error("Failed to capture AR scene");g().isMobile?await w({backgroundImage:t}):(x(t,"wmcyn-ar-".concat(e.metadata.id,".jpg")),alert("Image saved! Please upload this image to your Instagram story manually."))}catch(e){console.error("Error sharing to Instagram:",e),window.open("https://instagram.com","_blank")}},x=(e,t)=>{let a=URL.createObjectURL(e),n=document.createElement("a");n.href=a,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(a)};var C=a(2567),E=a.n(C);let R=e=>{let{onClose:t,configs:a=i}=e,o=(0,r.useRef)(null),[l,s]=(0,r.useState)(!0),[c,m]=(0,r.useState)(null),[h,p]=(0,r.useState)(!1),g=(0,r.useRef)(null),y=(0,r.useRef)(0);r.useEffect(()=>{console.log("ARCamera: Loading state changed to:",l)},[l]);let v=(0,r.useCallback)(e=>{var t;let a=Date.now();y.current=a,console.log("Marker detected: ".concat(e.name)),h?(null==c?void 0:c.name)!==e.name&&m(e):(m(e),p(!0)),g.current&&(clearTimeout(g.current),g.current=null),g.current=setTimeout(()=>{Date.now()-y.current>=2e3&&(console.log("Hiding metadata after 2 seconds of no detection"),p(!1),setTimeout(()=>{m(null)},200))},2e3),null===(t=e.onFound)||void 0===t||t.call(e)},[h,c]);d({mountRef:o,configs:(0,r.useMemo)(()=>a.map(e=>({...e,onFound:()=>v(e)})),[a,v]),setIsLoading:s}),r.useEffect(()=>{console.log("ARCamera: Adding cameraActive classes and applying body styles"),document.body.classList.add("cameraActive"),document.documentElement.classList.add("cameraActive");let e=document.documentElement,t=document.body,a={htmlOverflow:e.style.overflow,htmlWidth:e.style.width,htmlHeight:e.style.height,bodyOverflow:t.style.overflow,bodyPosition:t.style.position,bodyWidth:t.style.width,bodyHeight:t.style.height,bodyLeft:t.style.left,bodyTop:t.style.top,bodyMargin:t.style.margin,bodyPadding:t.style.padding};e.style.overflow="hidden",e.style.width="100vw",e.style.height="100vh",t.style.overflow="hidden",t.style.position="fixed",t.style.width="100vw",t.style.height="100vh",t.style.left="0",t.style.top="0",t.style.margin="0",t.style.padding="0",window.scrollTo(0,1);let n=()=>{setTimeout(()=>{if(window.scrollTo(0,1),o.current){let e=new Event("resize");window.dispatchEvent(e)}},100)};return window.addEventListener("orientationchange",n),window.addEventListener("resize",n),()=>{document.body.classList.remove("cameraActive"),document.documentElement.classList.remove("cameraActive"),g.current&&(clearTimeout(g.current),g.current=null);let e=document.documentElement,t=document.body;e.style.overflow=a.htmlOverflow,e.style.width=a.htmlWidth,e.style.height=a.htmlHeight,t.style.overflow=a.bodyOverflow,t.style.position=a.bodyPosition,t.style.width=a.bodyWidth,t.style.height=a.bodyHeight,t.style.left=a.bodyLeft,t.style.top=a.bodyTop,t.style.margin=a.bodyMargin,t.style.padding=a.bodyPadding,window.removeEventListener("orientationchange",n),window.removeEventListener("resize",n)}},[]);let f=async()=>{if(null==c?void 0:c.metadata){console.log("Sharing product:",c.metadata.id);try{var e,t;let a=null===(e=o.current)||void 0===e?void 0:e.querySelector("video"),n=null===(t=o.current)||void 0===t?void 0:t.querySelector("canvas");await A({metadata:{id:c.metadata.id,title:c.metadata.title,price:c.metadata.price,printLocation:c.metadata.printLocation,quantity:c.metadata.quantity},videoElement:a,canvasElement:n})}catch(e){console.error("Error sharing to Instagram:",e),alert("Failed to share to Instagram. Please try again.")}}};return(0,n.jsxs)("div",{className:E().arCameraContainer,children:[(0,n.jsx)("div",{ref:o,className:E().mountPoint}),l&&(0,n.jsx)("div",{className:E().loadingOverlay,children:"Initializing AR..."}),(null==c?void 0:c.metadata)&&(0,n.jsx)(u,{metadata:c.metadata,isVisible:h,onClaim:()=>{(null==c?void 0:c.metadata)&&console.log("Claiming product:",c.metadata.id)},onPurchase:()=>{(null==c?void 0:c.metadata)&&console.log("Purchasing product:",c.metadata.id)},onShare:f}),(0,n.jsx)("button",{onClick:t,className:E().closeButton,children:"Close AR"})]})}},2567:e=>{e.exports={arCameraContainer:"ARCamera_arCameraContainer__jxoSI",mountPoint:"ARCamera_mountPoint__oeW3w",loadingOverlay:"ARCamera_loadingOverlay__FsDdX",closeButton:"ARCamera_closeButton__FiWl_"}},7146:e=>{e.exports={overlay:"ARMetadataOverlay_overlay__FcBFd",slideUp:"ARMetadataOverlay_slideUp__S_Kr9",fadeOut:"ARMetadataOverlay_fadeOut__bh4yh",container:"ARMetadataOverlay_container__7m8MR",header:"ARMetadataOverlay_header__OM29E",title:"ARMetadataOverlay_title__7S_B3",status:"ARMetadataOverlay_status__AstsA",claimed:"ARMetadataOverlay_claimed__oj4xj",available:"ARMetadataOverlay_available__M1vQK",metadata:"ARMetadataOverlay_metadata__AL9kC",metadataRow:"ARMetadataOverlay_metadataRow__UthtV",label:"ARMetadataOverlay_label__t_umT",value:"ARMetadataOverlay_value__QGI3m",description:"ARMetadataOverlay_description__c_by_",actions:"ARMetadataOverlay_actions__7oO47",claimButton:"ARMetadataOverlay_claimButton__hPcVl",purchaseButton:"ARMetadataOverlay_purchaseButton__d9OIC",shareButton:"ARMetadataOverlay_shareButton__RL2Qf"}}}]);