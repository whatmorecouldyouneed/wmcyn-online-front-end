(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[309],{1340:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/pair",function(){return n(7339)}])},2145:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useMergedRef",{enumerable:!0,get:function(){return a}});let r=n(7294);function a(e,t){let n=(0,r.useRef)(()=>{}),a=(0,r.useRef)(()=>{});return(0,r.useMemo)(()=>e&&t?r=>{null===r?(n.current(),a.current()):(n.current=o(e,r),a.current=o(t,r))}:e||t,[e,t])}function o(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let n=e(t);return"function"==typeof n?n:()=>e(null)}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},7339:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>c});var r=n(5893),a=n(7294),o=n(1664),i=n.n(o),s=n(837);let l="https://us-central1-wmcyn-online-mobile.cloudfunctions.net/api";class d{static async createCode(){let e=await fetch("".concat(l,"/v1/auth/code.create"),{method:"POST",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Failed to create pairing code");return e.json()}static async attachCode(e,t){let n=await fetch("".concat(l,"/v1/auth/code.attach"),{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({code:e.toUpperCase()})});if(!n.ok)throw Error((await n.json()).error||"Failed to attach code");return n.json()}static async exchangeCode(e){let t=await fetch("".concat(l,"/v1/auth/code.exchange"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:e.toUpperCase()})}),n=await t.json();if(200===t.status)return{customToken:n.customToken};if(202===t.status)return{status:n.status};if(410===t.status)return{error:"expired"};throw Error(n.error||"Exchange failed")}}function c(){let{currentUser:e,getIdToken:t}=(0,s.a)(),[n,o]=(0,a.useState)(""),[l,c]=(0,a.useState)(!1),[p,f]=(0,a.useState)(null),[h,b]=(0,a.useState)(null),g=async r=>{if(r.preventDefault(),n.trim()&&e){f(null),b(null),c(!0);try{let e=await t();if(!e){f("Could not get authentication token");return}await d.attachCode(n.trim(),e),b("âœ… Successfully paired! Your VR headset should now be connected."),o(""),setTimeout(()=>b(null),5e3)}catch(e){f(e.message||"Failed to pair device. Please try again.")}finally{c(!1)}}};return e?(0,r.jsx)("main",{style:u.main,children:(0,r.jsxs)("div",{style:u.card,children:[(0,r.jsx)("h1",{style:u.h1,children:"Pair Your Headset"}),(0,r.jsx)("p",{style:{margin:"0 0 24px 0",fontSize:"16px",color:"#bbb",lineHeight:"1.5"},children:"Enter the 6-digit code shown on your VR headset"}),(0,r.jsxs)("form",{onSubmit:g,style:u.form,children:[(0,r.jsx)("div",{style:u.inputGroup,children:(0,r.jsx)("input",{type:"text",value:n,onChange:e=>o(e.target.value.toUpperCase()),placeholder:"Q7F9KJ",maxLength:6,style:u.codeInput,disabled:l})}),p&&(0,r.jsx)("div",{style:u.errorMsg,children:p}),h&&(0,r.jsx)("div",{style:u.successMsg,children:h}),(0,r.jsx)("button",{type:"submit",disabled:!n.trim()||l,style:{...u.submitBtn,...l?u.submitBtnDisabled:{}},children:l?"Pairing...":"Pair Device"})]}),(0,r.jsx)("small",{style:u.small,children:"Don't have a code? Start pairing on your VR headset first."})]})}):(0,r.jsx)("main",{style:u.main,children:(0,r.jsxs)("div",{style:u.card,children:[(0,r.jsx)("h1",{style:u.h1,children:"Pair Your Headset"}),(0,r.jsx)("p",{style:{margin:"0 0 32px 0",fontSize:"16px",color:"#bbb",lineHeight:"1.5"},children:"Please sign in to generate a pairing code."}),(0,r.jsx)(i(),{href:"/login",style:u.btnPrimary,children:"Go to Login"})]})})}let u={main:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",padding:"16px",background:"#0b0b0b",fontFamily:"system-ui, -apple-system, sans-serif"},card:{width:"100%",maxWidth:"400px",background:"#121212",color:"#ddd",borderRadius:16,padding:"24px",boxShadow:"0 8px 24px rgba(0,0,0,0.35)",textAlign:"center"},h1:{margin:"0 0 16px 0",fontSize:"28px",fontWeight:"600",color:"#fff"},btnPrimary:{display:"inline-block",background:"#2a5fff",color:"#fff",padding:"16px 24px",borderRadius:16,textDecoration:"none",fontSize:"16px",fontWeight:"600",transition:"all 0.2s ease"},small:{display:"block",marginTop:16,color:"#9a9a9a",fontSize:"14px",lineHeight:"1.4"},form:{display:"flex",flexDirection:"column",gap:16},inputGroup:{display:"flex",flexDirection:"column",gap:8},codeInput:{width:"100%",padding:"20px 16px",fontSize:"28px",fontFamily:"monospace",textAlign:"center",letterSpacing:"6px",background:"#1b1b1b",border:"2px solid #2a2a2a",borderRadius:16,color:"#fff",outline:"none",transition:"border-color 0.2s ease",boxSizing:"border-box",marginBottom:"8px"},submitBtn:{width:"100%",background:"#2a5fff",color:"#fff",padding:"18px 24px",borderRadius:16,border:"none",fontSize:"18px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",marginTop:"8px"},submitBtnDisabled:{background:"#1a1a1a",color:"#666",cursor:"not-allowed"},errorMsg:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#fca5a5",padding:"12px",borderRadius:8,fontSize:14},successMsg:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#86efac",padding:"12px",borderRadius:8,fontSize:14}}}},e=>{var t=t=>e(e.s=t);e.O(0,[664,888,774,179],()=>t(1340)),_N_E=e.O()}]);