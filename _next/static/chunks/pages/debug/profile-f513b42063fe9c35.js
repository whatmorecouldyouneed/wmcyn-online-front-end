(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[460],{8587:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/debug/profile",function(){return r(328)}])},328:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var n=r(5893),i=r(837),o=r(6242),a=r(8083),l=r(1163),s=r(7294);function d(){let{currentUser:e,getIdToken:t}=(0,i.a)(),r=(0,l.useRouter)(),d=(0,o.U)(),u=(0,a.m)(!0),c=async()=>{try{let e=await t();return console.log("[DEBUG] Token retrieved:",e?"".concat(e.substring(0,20),"..."):"null"),e}catch(e){return console.error("[DEBUG] Token error:",e),null}};return((0,s.useEffect)(()=>{c()},[c]),(0,s.useEffect)(()=>{e||r.push("/login")},[e,r]),e)?(0,n.jsxs)("main",{style:{padding:24,color:"white",fontFamily:"var(--font-outfit), sans-serif",background:"linear-gradient(180deg, rgba(20,20,30,1), rgba(10,10,15,1))",minHeight:"100vh"},children:[(0,n.jsx)("h1",{style:{marginBottom:"2rem",fontSize:"2rem"},children:"/debug/profile"}),(0,n.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,n.jsx)("h2",{style:{fontSize:"1.5rem",marginBottom:"1rem"},children:"Profile"}),(0,n.jsx)("pre",{style:{background:"rgba(30, 35, 50, 0.8)",padding:"1rem",borderRadius:"8px",overflow:"auto",fontSize:"14px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:JSON.stringify({loading:d.loading,error:d.error,data:d.data},null,2)})]}),(0,n.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,n.jsx)("h2",{style:{fontSize:"1.5rem",marginBottom:"1rem"},children:"Inventory"}),(0,n.jsx)("pre",{style:{background:"rgba(30, 35, 50, 0.8)",padding:"1rem",borderRadius:"8px",overflow:"auto",fontSize:"14px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:JSON.stringify({loading:u.loading,error:u.error,items:u.items},null,2)})]}),(0,n.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,n.jsx)("h2",{style:{fontSize:"1.5rem",marginBottom:"1rem"},children:"Current User"}),(0,n.jsx)("pre",{style:{background:"rgba(30, 35, 50, 0.8)",padding:"1rem",borderRadius:"8px",overflow:"auto",fontSize:"14px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:JSON.stringify({uid:e.uid,email:e.email,displayName:e.displayName,emailVerified:e.emailVerified},null,2)})]}),(0,n.jsx)("button",{onClick:()=>r.push("/debug/api-test"),style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",color:"white",padding:"0.75rem 1.5rem",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontFamily:"inherit",marginRight:"1rem"},children:"test API endpoint"}),(0,n.jsx)("button",{onClick:()=>r.push("/dashboard"),style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",color:"white",padding:"0.75rem 1.5rem",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontFamily:"inherit"},children:"back to dashboard"})]}):null}},8083:(e,t,r)=>{"use strict";r.d(t,{m:()=>o});var n=r(7294),i=r(4379);function o(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],[t,r]=(0,n.useState)(null),[o,a]=(0,n.useState)(!0),[l,s]=(0,n.useState)(null);return(0,n.useEffect)(()=>{let t=!0;return(async()=>{try{a(!0);let n=await (0,i.$v)(e);t&&r(n)}catch(e){var n;t&&s(null!==(n=null==e?void 0:e.message)&&void 0!==n?n:"Failed to load inventory")}finally{t&&a(!1)}})(),()=>{t=!1}},[e]),{items:t,loading:o,error:l}}},6242:(e,t,r)=>{"use strict";r.d(t,{U:()=>o});var n=r(7294),i=r(4379);function o(){let[e,t]=(0,n.useState)(null),[r,o]=(0,n.useState)(!0),[a,l]=(0,n.useState)(null);return(0,n.useEffect)(()=>{let e=!0;return(async()=>{try{o(!0);let r=await (0,i.US)();e&&t(r)}catch(t){var r;e&&l(null!==(r=null==t?void 0:t.message)&&void 0!==r?r:"Failed to load profile")}finally{e&&o(!1)}})(),()=>{e=!1}},[]),{data:e,loading:r,error:a}}},4379:(e,t,r)=>{"use strict";r.d(t,{$v:()=>s,US:()=>l});var n=r(7920);let i=r(4155).env.NEXT_PUBLIC_DEV_X_UID;async function o(){return(null===n.I8||void 0===n.I8?void 0:n.I8.currentUser)?await n.I8.currentUser.getIdToken():(console.warn("[apiClient] No currentUser - user not signed in"),null)}async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new Headers(t.headers||{});r.set("content-type","application/json");let a=await o();a?r.set("authorization","Bearer ".concat(a)):i&&r.set("x-uid",i);let l=async()=>fetch("".concat("https://us-central1-wmcyn-online-web.cloudfunctions.net/api").concat(e),{...t,headers:r,cache:"no-store"}),s=await l();if(401===s.status&&(null===n.I8||void 0===n.I8?void 0:n.I8.currentUser))try{let e=await n.I8.currentUser.getIdToken(!0);e&&(r.set("authorization","Bearer ".concat(e)),r.delete("x-uid"),s=await l())}catch(e){console.warn("[apiClient] Token refresh failed:",e)}if(401===s.status&&i&&(r.delete("authorization"),r.set("x-uid",i),s=await l()),!s.ok){let e=await s.text().catch(()=>"");throw console.error("[apiClient] Request failed:",s.status,e),Error(e||"request_failed_".concat(s.status))}return await s.json().catch(()=>({}))}let l=()=>a("/v1/profile/me"),s=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return a("/v1/profile/inventory".concat(e?"?includeProduct=true":""))}},1163:(e,t,r)=>{e.exports=r(3079)}},e=>{var t=t=>e(e.s=t);e.O(0,[888,774,179],()=>t(8587)),_N_E=e.O()}]);